import"./index.min2.js";import{g as p}from"./common.min.js";const v=()=>{const t=document.querySelectorAll("textarea[data-fls-input-autoheight]");if(t.length){let a=function(l,o){l.style.height=`${o}px`};t.forEach(l=>{const o=l.hasAttribute("data-fls-input-autoheight-min")?Number(l.dataset.flsInputAutoheightMin):Number(l.offsetHeight),e=l.hasAttribute("data-fls-input-autoheight-max")?Number(l.dataset.flsInputAutoheightMax):1/0;a(l,Math.min(o,e)),l.addEventListener("input",()=>{l.scrollHeight>o&&(l.style.height="auto",a(l,Math.min(Math.max(l.scrollHeight,o),e)))})})}};document.querySelector("textarea[data-fls-input-autoheight]")&&window.addEventListener("load",v);let i={getErrors(t){let a=0,l=t.querySelectorAll("[required]");return l.length&&l.forEach(o=>{(o.offsetParent!==null||o.tagName==="SELECT")&&!o.disabled&&(a+=this.validateInput(o))}),a},validateInput(t){let a=0;return t.type==="email"?(t.value=t.value.replace(" ",""),this.emailTest(t)?(this.addError(t),this.removeSuccess(t),a++):(this.removeError(t),this.addSuccess(t))):t.type==="checkbox"&&!t.checked?(this.addError(t),this.removeSuccess(t),a++):t.value.trim()?(this.removeError(t),this.addSuccess(t)):(this.addError(t),this.removeSuccess(t),a++),a},addError(t){t.classList.add("--form-error"),t.parentElement.classList.add("--form-error");let a=t.parentElement.querySelector("[data-fls-form-error]");a&&t.parentElement.removeChild(a),t.dataset.flsFormErrtext&&t.parentElement.insertAdjacentHTML("beforeend",`<div data-fls-form-error>${t.dataset.flsFormErrtext}</div>`)},removeError(t){t.classList.remove("--form-error"),t.parentElement.classList.remove("--form-error"),t.parentElement.querySelector("[data-fls-form-error]")&&t.parentElement.removeChild(t.parentElement.querySelector("[data-fls-form-error]"))},addSuccess(t){t.classList.add("--form-success"),t.parentElement.classList.add("--form-success")},removeSuccess(t){t.classList.remove("--form-success"),t.parentElement.classList.remove("--form-success")},removeFocus(t){t.classList.remove("--form-focus"),t.parentElement.classList.remove("--form-focus")},formClean(t){t.reset(),setTimeout(()=>{let a=t.querySelectorAll("input,textarea");for(let e=0;e<a.length;e++){const n=a[e];i.removeFocus(n),i.removeSuccess(n),i.removeError(n),n.classList.remove("--input-fill"),n.parentElement&&n.parentElement.classList.remove("--input-fill")}let l=t.querySelectorAll('input[type="checkbox"]');if(l.length&&l.forEach(e=>{e.checked=!1}),window.flsSelect){let e=t.querySelectorAll("select[data-fls-select]");e.length&&e.forEach(n=>{window.flsSelect.selectBuild(n)})}let o=t.querySelectorAll(".form-file");o.length&&o.forEach(e=>{let n=e.querySelector(".form-file__input"),s=e.querySelector(".form-file__file-name");n.value="",e.classList.remove("--file-added"),s.textContent=""})},0)},emailTest(t){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(t.value)}};function E(){function t(){const o=document.forms;if(o.length)for(const s of o)s.hasAttribute("data-fls-form-novalidate")||s.setAttribute("novalidate",!0),s.addEventListener("submit",function(r){const c=r.target;e(c,r)}),s.addEventListener("reset",function(r){const c=r.target;i.formClean(c)});async function e(s,r){if(i.getErrors(s)===0)if(s.dataset.flsForm==="ajax"){r.preventDefault();const f=s.getAttribute("action")?s.getAttribute("action").trim():"#",d=s.getAttribute("method")?s.getAttribute("method").trim():"GET",m=new FormData(s);s.classList.add("--sending");const u=await fetch(f,{method:d,body:m});if(u.ok){let h=await u.json();s.classList.remove("--sending"),n(s,h)}else s.classList.remove("--sending")}else s.dataset.flsForm==="dev"&&(r.preventDefault(),n(s));else if(r.preventDefault(),s.querySelector(".--form-error")&&s.hasAttribute("data-fls-form-gotoerr")){const f=s.dataset.flsFormGotoerr?s.dataset.flsFormGotoerr:".--form-error";p(f)}}function n(s,r=""){document.dispatchEvent(new CustomEvent("formSent",{detail:{form:s}})),setTimeout(()=>{if(window.flsPopup){const c=s.dataset.flsFormPopup;c&&window.flsPopup.open(c)}},0),i.formClean(s)}}function a(){document.body.addEventListener("focusin",function(o){const e=o.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.hasAttribute("data-fls-form-nofocus")||(e.classList.add("--form-focus"),e.parentElement.classList.add("--form-focus")),e.hasAttribute("data-fls-form-validatenow")&&i.removeError(e))}),document.body.addEventListener("focusout",function(o){const e=o.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.hasAttribute("data-fls-form-nofocus")||(e.classList.remove("--form-focus"),e.parentElement.classList.remove("--form-focus")),e.hasAttribute("data-fls-form-validatenow")&&i.validateInput(e))}),document.body.addEventListener("input",function(o){const e=o.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.value.trim()!==""?(e.classList.add("--input-fill"),e.parentElement.classList.add("--input-fill")):(e.classList.remove("--input-fill"),e.parentElement.classList.remove("--input-fill")))})}const l=document.querySelector(".form-file");if(l){const o=l.querySelector(".form-file__input"),e=l.querySelector(".form-file__btn");l.querySelector(".form-file__text");const n=l.querySelector(".form-file__file-name");e.addEventListener("click",()=>{o.click()}),o.addEventListener("change",()=>{if(o.files.length>0){const s=o.files[0].name;l.classList.add("--file-added"),n.textContent=s}else l.classList.remove("--file-added"),n.textContent=""})}t(),a()}document.querySelector("[data-fls-form]")&&window.addEventListener("load",E);
